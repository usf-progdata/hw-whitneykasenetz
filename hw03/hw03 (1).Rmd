# Homework 03

You will analyze data looking at the relationship between **green reputation** and three personality traits--**compassion**, **intellectual curiosity**, and **openness to experiences**.
The dataset includes data from **students** and **non-students**.

```{r}
dictionary <- readr::read_csv("green_dictionary.csv")
green_data <- readr::read_csv("green_data.csv")

library(dplyr)
library(ggplot2)
library(tidyverse)
library(psychTools)

```

```{r}
view(dictionary)
view(green_data)
```
 
 ## 1. Inspect the item responses (e.g., with graphs or by summarizing distinct values). Is anything unusual?

```{r inspection}
green_data %>% 
  summary()
#What's unusual here is that minimum values are "-99" for several of these items. I'm going to change the "-99" values to "NA."
```
```{r}
 #here I'm making a new variable called my_green_data and I'm changing green_data so it changes all the -99 data to "NA" 
green_data <- green_data %>% 
  mutate(across(everything(), 
                ~ na_if(.x, -99)))

view(green_data)
#Now there are no more "-99"s in my data.

```
## 2. Compute total scores for the four scales. Recode variables as needed.

```{r}
reversed <- dictionary %>% 
  filter(Keying < 0) %>% 
  pull(Item)
#making a new variable that filters those items that have a Keying less than 0 out of the dictionary. This will give me all the reverse coded variables, and I should get 14 of those. 

view(reversed)
#looks good, now I have a new variable with all the items I need to reverse code. 

#now I need to actually reverse code them
# here I'm changing all of my "reversed" values in green_data. changing 1 values to 5 values and so on. the names of the columns will be whatever they were before with an additional "_r" at the end.
green_data_r <- green_data %>% 
  mutate(
    across(all_of(reversed),
           ~ recode(.x, "1" = 5, "2" = 4, "3" = 3, "4" = 4, "5" = 1),
           .names = "{.col}_r")
  )

view(green_data_r) #why am I not seeing my column for open10_r when I run this code? 

#I guess I should move forward without using the the original items and only use the recoded ones
green_data_r <- select(green_data_r, -c("green2", "comp6", "comp7", "comp8", "comp9", "comp10", "intel7", "intel8", "intel9", "intel10", "open7", "open8", "open9", "open10"))

view(green_data_r) #ok, now I only have the recoded versions
#why do I see open10_r now? I guess problem solved? 

#computing totals for individuals

green_data_totals <- pomp_green_data %>% 
  rowwise() %>% 
  mutate(
          greenTotal = mean(c_across(c(green1, green2_r, green3:green5)), na.rm = TRUE),
          compTotal = mean(c_across(c(comp1:comp5, comp6_r:comp10_r)), na.rm = TRUE), 
          intTotal = mean(c_across(c(intel1:intel6, intel7_r:intel10_r)), na.rm = TRUE),
          openTotal = mean(c_across(c(open1:open6, open7_r:open10_r)), na.rm = TRUE)) %>% 
  select(id, student, greenTotal, compTotal, intTotal, openTotal)

```

## 3. Rescale the variables so that they go from 0-100 instead of the original range.
     Name the rescaled variables `*_pomp`.
```{r} 
pomp_green_data <- green_data_r %>% 
  mutate(across(c(green1:open10_r &!student), 
                ~recode(.x, "1" = 0, "2" = 25, "3" = 50, "4" = 75, "5" = 100), 
                .names = "{.col}_pomp"))

```
     
  4. Make plots that illustrate the distributions of the 4 POMP-scored variables.
  
```{r}

green <- (pomp_green_data$green1_pomp:pomp_green_data$green5_pomp)

pomp_green_data %>% 
  ggplot() +
  aes(x = green) +
  geom_histogram( color = "orange", fill = "orange")

```
  5. Make scatterplots showing the relationships between **green reputation** and each personality trait.
     Include trend lines for **students** and **non-students**.
     What do these plots show?
  6. Compare **green reputation** for students and non-students using a **rainfall plot** (bar + density + data points).
  7. Compute a summary table of means, SDs, medians, minima, and maxima for the four total scores for students and non-students.
  
In your assignment, prepare an RMarkdown file that includes both the coding and (for 4-7) narrative descriptions of your results.
